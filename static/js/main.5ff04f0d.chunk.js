(this["webpackJsonptodo-app"]=this["webpackJsonptodo-app"]||[]).push([[0],{34:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var c=n(11),a=n(23),r=(n(32),n(33),n(34),n(4)),o=n(0),s=n.n(o),i=n(3),u=n(5),l=n.n(u),d=n(6),j=n(8),m=n.n(j),b="https://mate.academy/students-api";function p(e){return new Promise((function(t){setTimeout(t,e)}))}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c={method:t};return n&&(c.body=JSON.stringify(n),c.headers={"Content-Type":"application/json; charset=UTF-8"}),p(300).then((function(){return fetch(b+e,c)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var O=function(e){return f(e)},h=function(e,t){return f(e,"POST",t)},x=function(e,t){return f(e,"PATCH",t)},v=function(e){return f(e,"DELETE")},g=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,c=t.name,e.abrupt("return",h("/users",{email:n,name:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=n(2),S=function(e){var t=e.onLogin,n=Object(o.useState)(""),c=Object(r.a)(n,2),a=c[0],s=c[1],u=Object(o.useState)(""),j=Object(r.a)(u,2),b=j[0],p=j[1],f=Object(o.useState)(!1),O=Object(r.a)(f,2),h=O[0],x=O[1],v=Object(o.useState)(!1),S=Object(r.a)(v,2),y=S[0],T=S[1],k=Object(o.useState)(""),w=Object(r.a)(k,2),C=w[0],E=w[1],P=Object(i.n)(),L=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e),P("/todos")};Object(o.useEffect)((function(){var e=localStorage.getItem("user");if(e){var n=JSON.parse(e);t(n)}}),[]);var D=function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(a);case 2:(t=e.sent)?L(t):x(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),E(""),T(!0),e.prev=3,!h){e.next=9;break}return e.next=7,N({name:b,email:a}).then(L);case 7:e.next=11;break;case 9:return e.next=11,D();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),E("Something went wrtong");case 16:return e.prev=16,T(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(_.jsxs)("form",{onSubmit:F,className:"box mt-5",children:[Object(_.jsx)("h1",{className:"title is-3",children:h?"You need to register":"Log in to open todos"}),Object(_.jsxs)("div",{className:"field",children:[Object(_.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(_.jsxs)("div",{className:m()("control has-icons-left",{"is-loading":y}),children:[Object(_.jsx)("input",{type:"email",id:"user-email",className:m()("input",{"is-danger":!h&&C}),placeholder:"Enter your email",disabled:y||h,value:a,required:!0,onChange:function(e){return s(e.target.value)}}),Object(_.jsx)("span",{className:"icon is-small is-left",children:Object(_.jsx)("i",{className:"fas fa-envelope"})})]}),!h&&C&&Object(_.jsx)("p",{className:"help is-danger",children:C})]}),h&&Object(_.jsxs)("div",{className:"field",children:[Object(_.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(_.jsxs)("div",{className:m()("control has-icons-left",{"is-loading":y}),children:[Object(_.jsx)("input",{type:"text",id:"user-name",className:m()("input",{"is-danger":h&&C}),placeholder:"Enter your name",required:!0,minLength:4,disabled:y,value:b,onChange:function(e){return p(e.target.value)}}),Object(_.jsx)("span",{className:"icon is-small is-left",children:Object(_.jsx)("i",{className:"fas fa-user"})})]}),h&&C&&Object(_.jsx)("p",{className:"help is-danger",children:C})]}),Object(_.jsx)("div",{className:"field",children:Object(_.jsx)("button",{type:"submit",className:m()("button is-primary",{"is-loading":y}),children:h?"Register":"Login"})})]})},y=n(10),T=function(e,t){return x("/todos/".concat(e),t)},k=function(e){return v("/todos/".concat(e))},w=s.a.memo((function(e){var t=e.item,n=e.key,c=e.setTodoStatus,a=e.removeTodo,s=e.changeTodoTitle,i=Object(o.useState)(!1),u=Object(r.a)(i,2),l=u[0],d=u[1],j=Object(o.useState)(""),b=Object(r.a)(j,2),p=b[0],f=b[1];return Object(_.jsxs)("li",{className:m()("todo",{completed:t.completed,editing:l}),onDoubleClick:function(){return d(!0)},children:[Object(_.jsx)("label",{className:"todo__status-label",children:Object(_.jsx)("input",{type:"checkbox",className:"todo__status",checked:t.completed,onChange:function(){return c(t.id)}})}),l?Object(_.jsx)("input",{type:"text",className:"todo__title-field",value:p,autoFocus:!0,onChange:function(e){return f(e.target.value)},onBlur:function(){p&&s(t.id,p),f(""),d(!1)},onKeyDown:function(e){"Enter"===e.code&&p&&(s(t.id,p),f(""),d(!1)),"Escape"===e.code&&(f(""),d(!1))}}):Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("span",{className:"todo__title",children:t.title}),Object(_.jsx)("button",{type:"button",className:"todo__remove","data-cy":"deleteTodo",onClick:function(){return a(t.id)},children:"x"})]})]},n)})),C=function(e){var t=e.todos,n=e.setTodoStatus,c=e.removeTodo,a=e.changeTodoTitle;return Object(_.jsx)("section",{className:"todoapp__main",children:t.map((function(e){return Object(_.jsx)(w,{item:e,setTodoStatus:n,removeTodo:c,changeTodoTitle:a},e.id)}))})},E=function(e){var t=e.sortParam,n=e.setSortParam;return Object(_.jsxs)("nav",{className:"filters",children:[Object(_.jsx)(c.b,{to:"../",className:m()("filter__link",{selected:"all"===t}),onClick:function(){return n("all")},children:"All"}),Object(_.jsx)(c.b,{to:"../active",className:m()("filter__link",{selected:"active"===t}),onClick:function(){return n("active")},children:"Active"}),Object(_.jsx)(c.b,{to:"../completed",className:m()("filter__link",{selected:"completed"===t}),onClick:function(){return n("completed")},children:"Completed"})]})},P=s.a.memo((function(e){var t=e.user,n=Object(o.useState)([]),c=Object(r.a)(n,2),a=c[0],s=c[1],i=Object(o.useState)(""),u=Object(r.a)(i,2),l=u[0],d=u[1],j=Object(o.useState)(!1),b=Object(r.a)(j,2),p=b[0],f=b[1],x=Object(o.useState)(!1),v=Object(r.a)(x,2),g=v[0],N=v[1],S=Object(o.useState)("all"),w=Object(r.a)(S,2),P=w[0],L=w[1];Object(o.useEffect)((function(){var e;(e=t.id,O("/todos?userId=".concat(e))).then(s)}),[p]);var D=function(){f((function(e){return!e}))},F=Object(o.useMemo)((function(){return a.reduce((function(e,t){return t.completed?e:e+1}),0)}),[a]),I=Object(o.useMemo)((function(){var e=a.reduce((function(e,t){return t.completed?e+1:e}),0);return function(e){e===a.length&&a.length>0&&N(!0),0===e&&N(!1)}(e),e}),[a]),J=Object(o.useMemo)((function(){switch(P){case"active":return a.filter((function(e){return!e.completed}));case"completed":return a.filter((function(e){return e.completed}));default:return a}}),[P,a]);return Object(_.jsxs)("div",{className:"todoapp",children:[Object(_.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(_.jsxs)("div",{className:"todoapp__content",children:[Object(_.jsxs)("header",{className:"todoapp__header",children:[a.length>0&&Object(_.jsx)("button",{type:"button",className:m()("todoapp__toggle-all",{"is-active":g}),onClick:function(){s(g?function(e){return e.map((function(e){return e.completed?(T(e.id,{completed:!1}),Object(y.a)(Object(y.a)({},e),{},{completed:!1})):(N(!1),e)}))}:function(e){return e.map((function(e){return e.completed?(N(!0),e):(T(e.id,{completed:!0}),Object(y.a)(Object(y.a)({},e),{},{completed:!0}))}))})}}),Object(_.jsx)("form",{onSubmit:function(e){var n,c;e.preventDefault(),l&&((n=l,c=t.id,h("/todos",{title:n,userId:c,completed:!1})).then(D),d(""))},children:Object(_.jsx)("input",{type:"text","data-cy":"createTodo",className:"todoapp__new-todo",placeholder:"What needs to be done?",value:l,onChange:function(e){var t=e.target;d(t.value)}})})]}),Object(_.jsx)(C,{todos:J,setTodoStatus:function(e){s((function(t){return t.map((function(t){return t.id===e?(t.completed&&N(!1),T(e,{completed:!t.completed}),Object(y.a)(Object(y.a)({},t),{},{completed:!t.completed})):t}))}))},removeTodo:function(e){s((function(t){return t.filter((function(t){return t.id===e&&k(e),t.id!==e}))}))},changeTodoTitle:function(e,t){s((function(n){return n.map((function(n){return n.id===e?(T(e,{title:t}),Object(y.a)(Object(y.a)({},n),{},{title:t})):n}))}))}}),a.length>0&&Object(_.jsxs)("footer",{className:"todoapp__footer",children:[Object(_.jsx)("span",{className:"todo-count",children:F>0&&"".concat(F," ").concat(F>1?"items":"item"," left")}),Object(_.jsx)(E,{sortParam:P,setSortParam:L}),Object(_.jsx)("button",{type:"button",className:"todoapp__clear-completed",onClick:function(){s((function(e){return e.filter((function(e){return e.completed&&k(e.id),!e.completed}))}))},children:0!==I&&"Clear completed"})]})]})]})})),L=function(){var e=Object(o.useState)(null),t=Object(r.a)(e,2),n=t[0],c=t[1];return Object(_.jsxs)(i.d,{children:[Object(_.jsx)(i.b,{path:"/",element:Object(_.jsx)(S,{onLogin:c})}),Object(_.jsxs)(i.b,{path:"todos",children:[Object(_.jsx)(i.b,{index:!0,element:n?Object(_.jsx)(P,{user:n}):Object(_.jsx)(i.a,{to:"/"})}),Object(_.jsx)(i.b,{path:":filterParam",element:n&&Object(_.jsx)(P,{user:n})})]})]})};Object(a.createRoot)(document.getElementById("root")).render(Object(_.jsx)(c.a,{children:Object(_.jsx)(L,{})}))}},[[37,1,2]]]);
//# sourceMappingURL=main.5ff04f0d.chunk.js.map